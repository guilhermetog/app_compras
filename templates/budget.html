{% extends "base.html" %}

{% block title %}Or√ßamento Mensal - App Compras{% endblock %}

{% block content %}
<div class="card">
    <h2>Or√ßamento Mensal de Compras</h2>
    <p>C√°lculo baseado na demanda mensal e estoque atual dos produtos.</p>
    
    <div class="stat-card" style="margin-top: 1.5rem;">
        <h3>Or√ßamento Estimado para o M√™s</h3>
        <div class="value">R$ {{ "%.2f"|format(total_budget) }}</div>
    </div>
</div>

{% if budget_items %}
<div class="card">
    <h3>Detalhamento do Or√ßamento</h3>
    <table>
        <thead>
            <tr>
                <th>Produto</th>
                <th>Estoque Atual</th>
                <th>Demanda Mensal</th>
                <th>Necess√°rio Comprar</th>
                <th>Pre√ßo/Unidade</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody>
            {% for item in budget_items %}
            <tr>
                <td><a href="/product/{{ item.product.id }}" style="color: #3498db; text-decoration: none;">{{ item.product.name }}</a></td>
                <td>{{ item.product.stock_quantity }}</td>
                <td>{{ item.product.monthly_demand }}</td>
                <td>{{ "%.2f"|format(item.quantity_needed) }}</td>
                <td>R$ {{ "%.2f"|format(item.price) }}</td>
                <td>R$ {{ "%.2f"|format(item.total) }}</td>
            </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr style="font-weight: bold; background: #f8f9fa;">
                <td colspan="5" style="text-align: right;">Total:</td>
                <td>R$ {{ "%.2f"|format(total_budget) }}</td>
            </tr>
        </tfoot>
    </table>
</div>
{% else %}
<div class="card">
    <p>‚úì Voc√™ tem estoque suficiente para este m√™s! N√£o √© necess√°rio comprar nada no momento.</p>
</div>
{% endif %}

<div style="margin-top: 1rem;">
    <a href="/shopping-list/create" class="btn btn-success">üìù Criar Lista de Compras</a>
    <a href="/" class="btn">‚Üê Voltar</a>
</div>
{% endblock %}
